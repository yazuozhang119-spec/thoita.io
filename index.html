<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=0.5, maximum-scale=2.0, user-scalable=yes">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <meta charset="latin-1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Florr.io ÁΩëÈ°µÁâà</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="gameContainer">
        <canvas id="gameCanvas"></canvas>
        <button id="exitButton" class="exit-button">√ó</button>
        <div id="ui">
            <div id="healthBar">
                <div id="healthFill"></div>
            </div>
            <div id="fps">FPS: 0</div>
            <div id="inventory">
                <!-- Ë£ÖÂ§áÁöÑËä±Áì£Â∞ÜÈÄöËøáJavaScriptÂä®ÊÄÅÁîüÊàê -->
            </div>
        </div>
        <div id="waveBar">
            <div id="waveText">Wave: 1</div>
            <div id="waveProgressContainer">
                <div id="waveProgressFill"></div>
            </div>
        </div>

        <div id="startScreen">
            <h1>thoita.io</h1>

            <!-- ÁôªÂΩïË°®Âçï -->
            <div id="loginForm" class="auth-form">
                <h2>ÁôªÂΩïË¥¶Êà∑</h2>
                <div class="form-group">
                    <input type="text" id="loginUsername" placeholder="Áî®Êà∑Âêç" maxlength="20">
                </div>
                <div class="form-group">
                    <input type="password" id="loginPassword" placeholder="ÂØÜÁ†Å" maxlength="50">
                </div>
                <div class="form-options">
                    <label class="checkbox-label">
                        <input type="checkbox" id="rememberMe" checked>
                        <span>ËÆ∞‰ΩèÂØÜÁ†Å</span>
                    </label>
                </div>
                <button id="loginButton" class="auth-button">ÁôªÂΩï</button>
                <p class="auth-switch">
                    ËøòÊ≤°ÊúâË¥¶Êà∑Ôºü<a href="#" id="showRegister">Á´ãÂç≥Ê≥®ÂÜå</a>
                </p>
            </div>

            <!-- Ê≥®ÂÜåË°®Âçï -->
            <div id="registerForm" class="auth-form" style="display: none;">
                <h2>Ê≥®ÂÜåË¥¶Êà∑</h2>
                <div class="form-group">
                    <input type="text" id="registerUsername" placeholder="Áî®Êà∑Âêç" maxlength="20">
                </div>
                <div class="form-group">
                    <input type="password" id="registerPassword" placeholder="ÂØÜÁ†Å" maxlength="50">
                </div>
                <div class="form-group">
                    <input type="password" id="confirmPassword" placeholder="Á°ÆËÆ§ÂØÜÁ†Å" maxlength="50">
                </div>
                <div class="form-options">
                    <label class="checkbox-label">
                        <input type="checkbox" id="registerRememberMe" checked>
                        <span>ËÆ∞‰ΩèÂØÜÁ†Å</span>
                    </label>
                </div>
                <button id="registerButton" class="auth-button">Ê≥®ÂÜå</button>
                <p class="auth-switch">
                    Â∑≤ÊúâË¥¶Êà∑Ôºü<a href="#" id="showLogin">Á´ãÂç≥ÁôªÂΩï</a>
                </p>
            </div>

            <!-- ÈîôËØØ‰ø°ÊÅØÊòæÁ§∫ -->
            <div id="authError" class="auth-error" style="display: none;"></div>

            <!-- ÊóßÁâàÊú¨ÂÖºÂÆπÔºàÈöêËóèÔºâ -->
            <div id="legacyLogin" style="display: none;">
                <input type="text" id="playerName" placeholder="ËæìÂÖ•‰Ω†ÁöÑÂêçÂ≠ó" value="Player">
                <button id="startButton">ÂºÄÂßãÊ∏∏Êàè</button>
            </div>
        </div>

        <!-- Â§ßÂéÖÁïåÈù¢ - ‰∏éÁôªÂΩïÁïåÈù¢Âπ≥Á∫ß -->
        <div id="lobbyUI" style="display:none;">
            <div id="lobbyLayout">
                <div id="leftPanel">
                    <div id="buttonContainer">
                        <button class="lobby-button" id="bagButton">ËÉåÂåÖ</button>
                                                <button class="lobby-button" id="absorbLobbyButton">ÂêàÊàê</button>
                        <button class="lobby-button" id="galleryButton">ÂõæÈâ¥</button>
                    </div>
                </div>

                <div id="mainPanel">
                    <!-- Â§ßÂéÖÊ†áÈ¢ò -->
                    <h1 id="lobbyTitle" style="color: white; text-align: center; margin: 20px 0; font-size: 48px; text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">thoita.io</h1>
                    <div id="equipmentSlots">
                        <!-- Ë£ÖÂ§áÊßΩÂ∞ÜÈÄöËøáJSÂä®ÊÄÅÁîüÊàê -->
                    </div>

                    <div id="selectRoomMessage" style="color: white; font-size: 16px; margin-bottom: 15px; text-align: center; display: none;">ËØ∑ÈÄâÊã©ÊàøÈó¥</div>
                    <div id="roomButtons" style="display: flex; gap: 10px; margin-bottom: 10px; justify-content: center;">
                    <button id="newRoomButton" class="room-action-button">Êñ∞Âª∫ÊàøÈó¥</button>
                    <button id="findRoomButton" class="room-action-button">ÂØªÊâæ</button>
                    <button id="privateRoomButton" class="room-action-button">ÁßÅ‰∫∫ÊàøÈó¥</button>
                </div>
                <button id="readyButton">Ready</button>

                    <div id="roomInfo">
                        <div id="noRoomMessage" style="color: rgba(255, 255, 255, 0.6); font-size: 14px; text-align: center; padding: 20px;">Ê≤°ÊúâÊàøÈó¥‰ø°ÊÅØ</div>
                        <div id="roomWaveSettings" style="display: none;">
                            <div class="wave-setting-container">
                                <label for="startWaveSlider"></label>
                                <div class="slider-container">
                                    <input type="range" id="startWaveSlider" min="0" max="1" value="1" class="wave-slider">
                                    <div class="slider-value-display">
                                        <span id="startWaveValue">1</span>
                                    </div>
                                </div>
                            </div>
                            <div class="wave-info-container">
                                <div class="wave-info-item">
                                    <span class="wave-info-label">ÊàøÈó¥Ëµ∑ÂßãÊ≥¢Ê¨°:</span>
                                    <span id="roomStartWave" class="wave-info-value">1</span>
                                </div>
                                <div class="wave-info-item">
                                    <span class="wave-info-label">‰Ω†ÁöÑËµ∑ÂßãÊ≥¢Ê¨°:</span>
                                    <span id="playerStartWave" class="wave-info-value">1</span>
                                </div>
                            </div>
                        </div>
                        <div id="roomPlayers">
                            <h4>ÊàøÈó¥Áé©ÂÆ∂</h4>
                            <!-- ÊàøÈó¥ÂÜÖÂÖ∂‰ªñÁé©ÂÆ∂Â∞ÜÈÄöËøáJSÂä®ÊÄÅÁîüÊàê -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="bagWindow">
            <button class="close-button" id="closeBag">X</button>
            <div id="bagContent">
                <!-- ËÉåÂåÖÂÜÖÂÆπÂ∞ÜÈÄöËøáJSÂä®ÊÄÅÁîüÊàê -->
            </div>
        </div>

        <!-- Ëá™ÂÆö‰πâtooltip -->
        <div id="petalTooltip" class="petal-tooltip" style="display: none;">
            <div class="tooltip-content"></div>
        </div>

        <div id="absorbWindow">
            <button class="close-button" id="closeAbsorb">X</button>

            <!-- ‰∫îËæπÂΩ¢ÊéíÂàóÁöÑ‰∫î‰∏™ÂêàÊàêÊßΩ‰Ωç -->
            <div id="absorbSlotsContainer">
                <div class="pentagon-slots">
                    <div class="absorb-slot" data-index="0"></div>
                    <div class="absorb-slot" data-index="1"></div>
                    <div class="absorb-slot" data-index="2"></div>
                    <div class="absorb-slot" data-index="3"></div>
                    <div class="absorb-slot" data-index="4"></div>
                </div>
                <div id="absorbCenter">
                    <div id="absorbButtonContainer">
                        <button id="absorbActionButton" disabled>ÂêàÊàê</button>
                        <div id="absorbChanceText" style="font-size: 12px; color: #888; margin-top: 5px; min-height: 16px; white-space: nowrap;"></div>
                        <div id="pityInfoText" style="font-size: 11px; color: #666; margin-top: 3px; min-height: 14px; white-space: nowrap;"></div>
                    </div>
                </div>
            </div>

            <!-- ÂêàÊàêÁªìÊûúÊòæÁ§∫Âå∫Âüü -->
            <div id="absorbResult" style="display: none;">
                <h3>ÂêàÊàêÁªìÊûú</h3>
                <div id="resultContent"></div>
                <button id="closeResult">ÂÖ≥Èó≠</button>
            </div>

            <!-- Ëä±Áì£ÈÄâÊã©Âå∫Âüü -->
            <div class="petal-selection-area">
                <div id="absorbPetalSelection" class="petal-selection">
                    <!-- Ëä±Áì£Â∞ÜÈÄöËøáJavaScriptÂä®ÊÄÅÁîüÊàê -->
                </div>
            </div>
            </div>
        </div>

        <div id="checkinWindow">
            <div class="checkin-light-cones" id="checkinLightCones"></div>
                        <div id="checkinStreakDisplay" style="display: none;">
                <div id="checkinStreakText"></div>
            </div>
            <div id="checkinContent">
                <div id="checkinStatus">
                    <p id="checkinMessage">Ê≠£Âú®Ëé∑ÂèñÁ≠æÂà∞Áä∂ÊÄÅ...</p>
                </div>
                <div id="checkinButtonContainer">
                    <button id="checkinActionButton" class="checkin-button" disabled>CLAIM</button>
                </div>
                <div id="checkinRewardDisplay" style="display: none;">
                    <div id="checkinRewardText">Reward:</div>
                    <div id="checkinRewardItems"></div>
                </div>
            </div>
        </div>

        <div id="galleryWindow">
            <button class="close-button" id="closeGallery">X</button>
            <div class="gallery-content">
                <div class="monster-selection-area">
                    <div id="monsterSelection" class="monster-selection">
                        <!-- ÊÄ™Áâ©Â∞ÜÈÄöËøáJavaScriptÂä®ÊÄÅÁîüÊàê -->
                    </div>
                </div>
            </div>
        </div>

        <div id="gameOver">
            <h2>Ê∏∏ÊàèÁªìÊùü</h2>
            <button id="restartButton">ÈáçÊñ∞ÂºÄÂßã</button>
        </div>

        <!-- Ê≠ª‰∫°Êó∂ÊòæÁ§∫ÁöÑÊãæÂèñÊéâËêΩÁâ© -->
        <div id="deathDrops" style="display: none;">
            <div id="deathDropsHeader">
                <h3>ÊãæÂèñÁöÑÊéâËêΩÁâ©</h3>
            </div>
            <div id="deathDropsContent">
                <!-- ÊéâËêΩÁâ©Â∞ÜÊåâÁÖßËÉåÂåÖÊéíÂàóÊñπÂºèÊòæÁ§∫ -->
            </div>
        </div>

        <div id="loadingScreen">
            <h2>Âä†ËΩΩËµÑÊ∫ê</h2>
            <div id="progressBar">
                <div id="progressFill"></div>
            </div>
            <div id="loadingText">0%</div>
        </div>

        <!-- ËÅäÂ§©ÁïåÈù¢ -->
        <div id="chatContainer">
            <div id="chatHeader">
                <span id="chatTitle">ËÅäÂ§©</span>
                <div>
                    <button id="chatClose">√ó</button>
                </div>
            </div>
            <div id="chatMessages"></div>
            <div id="chatTypeSelector">
                <button class="chat-type-button active" data-type="room">ÊàøÈó¥</button>
                <button class="chat-type-button" data-type="global">ÂÖ®Â±Ä</button>
                <button class="chat-type-button" data-type="private">ÁßÅËÅä</button>
            </div>
            <div id="chatInputContainer">
                <input type="text" id="chatInput" placeholder="ËæìÂÖ•Ê∂àÊÅØ..." maxlength="200">
                <button id="chatSendButton">ÂèëÈÄÅ</button>
            </div>
        </div>

        <!-- ÈáçÊñ∞ÊâìÂºÄËÅäÂ§©ÊåâÈíÆ -->
        <button id="chatOpenButton" style="display: none;">üí¨</button>

        <!-- ËÆæÁΩÆÊåâÈíÆ -->
        <div id="settingsButton">
            <button id="settingsToggle" class="settings-button">‚öôÔ∏è</button>
        </div>

        <!-- ËÆæÁΩÆÈù¢Êùø -->
        <div id="settingsPanel" class="settings-panel" style="display: none;">
            <div class="settings-header">
                <span>ËÆæÁΩÆ</span>
                <button id="settingsClose" class="settings-close">√ó</button>
            </div>
            <div class="settings-content">
                <!-- ÈîÆÁõòÁßªÂä® -->
                <div class="settings-section">
                    <div class="setting-toggle">
                        <label class="toggle-label">
                            <input type="checkbox" id="keyboardMovementToggle">
                            <span class="toggle-text">ÈîÆÁõòÁßªÂä®</span>
                        </label>
                        <div class="toggle-switch">
                            <div class="toggle-slider"></div>
                        </div>
                    </div>
                </div>

                <!-- Èü≥ÈáèÊéßÂà∂ -->
                <div class="settings-section">
                    <div class="volume-control-horizontal">
                        <span class="volume-label">Èü≥Èáè</span>
                        <div class="volume-slider-wrapper">
                            <input type="range" id="volumeRange" min="0" max="100" value="50" class="volume-slider">
                            <span id="volumeValue">50%</span>
                        </div>
                    </div>
                </div>

                <!-- ÊòæÁ§∫ÂÆû‰Ωì -->
                <div class="settings-section">
                    <div class="setting-toggle">
                        <label class="toggle-label">
                            <input type="checkbox" id="showEntitiesToggle" checked>
                            <span class="toggle-text">ÊòæÁ§∫ÂÆû‰Ωì</span>
                        </label>
                        <div class="toggle-switch">
                            <div class="toggle-slider"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        </div>

    <script src="flower.js"></script>
    <script src="petals_data.js"></script>
    <script src="monsters_data.js"></script>
    <script src="game.js"></script>
    <script src="auth.js"></script>
</body>
</html>