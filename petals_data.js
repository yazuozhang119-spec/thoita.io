/**
 * èŠ±ç“£æ•°å€¼å’Œæœºåˆ¶æ•°æ®
 * åŒ…å«æ‰€æœ‰èŠ±ç“£ç±»å‹çš„è¡€é‡ã€ä½“ä¼¤ã€é‡é‡ã€å›è¡€å’Œç‰¹æ®Šæœºåˆ¶
 * å‰ç«¯å¯ä»¥ç›´æ¥è°ƒç”¨æ­¤æ–‡ä»¶æ˜¾ç¤ºèŠ±ç“£ä¿¡æ¯
 */

const PETALS_DATA = {
    // èŠ±ç“£ç±»å‹æ˜ å°„ (æ ¹æ®æœåŠ¡å™¨allPetalsæ•°ç»„é¡ºåº)
    TYPE_MAP: {
        0: 'missile',
        1: 'basic',
        2: 'hornet_missile',  // ç´¢å¼•2æ˜¯é»„èœ‚å¯¼å¼¹
        3: 'leaf',
        4: 'wing',
        5: 'thunder',
        6: 'venom',
        7: 'shield',
        8: 'bomb',
        9: 'magnet',
        10: 'thirdeye',
        11: 'stinger',
        12: 'orange',
        13: 'egg',
        14: 'square',
        15: 'pearl'
    },

    // èŠ±ç“£åŸºç¡€å±æ€§ (å†·å´æ—¶é—´ç§’)
    COOLDOWNS: {
        missile: 2.5,
        basic: 2.5,
        hornet_missile: null,  // ç‰¹æ®Šæœºåˆ¶ï¼Œæ— å›ºå®šå†·å´
        leaf: 1.0,
        wing: 1.0,
        thunder: 3.0,
        venom: 2.8,
        shield: 4.0,
        bomb: 3.5,
        magnet: 2.0,
        thirdeye: 2.2,
        stinger: 5.0,
        orange: 2.0,
        egg: 2.0,
        square: 5.0,
        pearl: 2.0
    },

    // èŠ±ç“£åç§° (ä¸­æ–‡æ˜¾ç¤º)
    NAMES: {
        missile: 'å¯¼å¼¹',
        basic: 'åŸºç¡€',
        leaf: 'å¶å­',
        wing: 'ç¿…è†€',
        thunder: 'é›·ç”µ',
        venom: 'é¸¢å°¾èŠ±',
        shield: 'æŠ¤ç›¾',
        bomb: 'ç‚¸å¼¹',
        hornet_missile: 'é»„èœ‚å¯¼å¼¹',
        magnet: 'ç£é“',
        thirdeye: 'ç¬¬ä¸‰åªçœ¼',
        stinger: 'åˆºé’ˆ',
        orange: 'æ©™å­',
        egg: 'è›‹',
        square: 'æ–¹å½¢',
        pearl: 'çç '
    },

    // èŠ±ç“£æè¿°
    DESCRIPTIONS: {
        missile: 'å‘å°„å¯¼å¼¹ï¼Œé€ æˆå•ä½“é«˜é¢ä¼¤å®³ï¼Œå‘å°„è·ç¦»200åƒç´ ',
        basic: 'åŸºç¡€èŠ±ç“£ï¼Œæä¾›ç¨³å®šçš„ä¼¤å®³è¾“å‡º',
        leaf: 'å¶å­èŠ±ç“£ï¼Œå¹³è¡¡çš„è¡€é‡å’Œä¼¤å®³',
        wing: 'ç¿…è†€èŠ±ç“£ï¼Œå…·æœ‰ç‰¹æ®Šçš„é£è¡Œè½¨è¿¹æ”»å‡»æ¨¡å¼',
        thunder: 'é›·ç”µèŠ±ç“£ï¼Œé€ æˆè¿é”é—ªç”µä¼¤å®³ï¼Œå¯æ”»å‡»å¤šä¸ªç›®æ ‡',
        venom: 'é¸¢å°¾èŠ±ç“£ï¼Œæ–½åŠ æŒç»­ä¸­æ¯’ä¼¤å®³æ•ˆæœ',
        shield: 'è´å£³èŠ±ç“£ï¼Œæ¯3ç§’è‡ªåŠ¨å‘å°„ä¸‰ä¸ªä½ä¸€çº§çš„çç å¼¹ä¸¸',
        bomb: 'ç‚¸å¼¹èŠ±ç“£ï¼Œæ­»äº¡æ—¶çˆ†ç‚¸é€ æˆèŒƒå›´ä¼¤å®³',
        hornet_missile: 'é»„èœ‚å¯¼å¼¹ï¼Œé«˜é€Ÿè¿½è¸ªå¯¼å¼¹',
        magnet: 'ç£é“èŠ±ç“£ï¼Œæ‰©å¤§ç‰©å“æ‹¾å–èŒƒå›´',
        thirdeye: 'ç¬¬ä¸‰åªçœ¼èŠ±ç“£ï¼Œæ‰©å¤§èŠ±ç“£å…¬è½¬åŠå¾„',
        stinger: 'åˆºé’ˆèŠ±ç“£ï¼Œå¤šå•ä½“æ”»å‡»ï¼Œæ¯ä¸ªåˆºé’ˆç‹¬ç«‹è¡€é‡å’Œæ”»å‡»',
        orange: 'æ©™å­èŠ±ç“£ï¼Œå¤šå•ä½“æ”»å‡»ï¼Œç±»ä¼¼åˆºé’ˆæœºåˆ¶',
        egg: 'è›‹èŠ±ç“£ï¼Œå­µåŒ–å‡ºçˆ†ç‚¸ç”²è™«ååŠ©æˆ˜æ–—',
        square: 'æ–¹å½¢èŠ±ç“£ï¼ŒåŸºç¡€èŠ±ç“£çš„æŠ¤ç›¾å˜ä½“',
        pearl: 'çç èŠ±ç“£ï¼Œç±»ä¼¼å¯¼å¼¹ä½†å°„ç¨‹æ›´è¿œï¼Œå¯å‘å°„çç å¼¹ä¸¸'
    },

    // èŠ±ç“£è¡€é‡æ•°æ® (1-19çº§)
    HEALTH: {
        missile: [0, 10, 20, 40, 80, 160, 320, 640, 1280, 2560, 5120, 10240, 20480, 40960, 81920, 163840, 327680, 655360, 1310720, 2621440],
        basic: [0, 10, 20, 40, 80, 160, 320, 640, 1280, 2560, 5120, 10240, 20480, 40960, 81920, 163840, 327680, 655360, 1310720, 2621440],
        leaf: [0, 10, 20, 40, 80, 160, 320, 640, 1280, 2560, 5120, 10240, 20480, 40960, 81920, 163840, 327680, 655360, 1310720, 2621440],
        wing: [0, 12, 24, 48, 96, 192, 384, 768, 1536, 3072, 6144, 12288, 24576, 49152, 98304, 196608, 393216, 786432, 1572864, 3145728],
        thunder: [0, 14, 28, 56, 112, 224, 448, 896, 1792, 3584, 7168, 14336, 28672, 57344, 114688, 229376, 458752, 917504, 1835008, 3670016],
        venom: [0, 10, 20, 40, 80, 160, 320, 640, 1280, 2560, 5120, 10240, 20480, 40960, 81920, 163840, 327680, 655360, 1310720, 2621440],
        shield: [0, 20, 40, 80, 160, 320, 640, 1280, 2560, 5120, 10240, 20480, 40960, 81920, 163840, 327680, 655360, 1310720, 2621440, 5242880],
        bomb: [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        hornet_missile: [0, 5, 15, 45, 135, 405, 1215, 3645, 10935, 32805, 98415, 295245, 885735, 2657205, 7971615, 23914845, 71744535, 215233605, 645700815, 1937102445],
        magnet: [0, 12, 24, 48, 96, 192, 384, 768, 1536, 3072, 6144, 12288, 24576, 49152, 98304, 196608, 393216, 786432, 1572864, 3145728],
        thirdeye: [0, 14, 28, 56, 112, 224, 448, 896, 1792, 3584, 7168, 14336, 28672, 57344, 114688, 229376, 458752, 917504, 1835008, 3670016],
        stinger: [0, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 65536, 131072, 262144, 524288, 1048576, 2097152],
        orange: [0, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 65536, 131072, 262144, 524288, 1048576, 2097152],
        egg: [0, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 65536, 131072, 262144, 524288, 1048576, 2097152],
        square: [0, 2000, 4600, 10580, 24334, 55968, 128726, 296069, 680958, 1566203, 3602266, 8285209, 19055979, 43828750, 100806124, 231854084, 533264392, 1226508100, 2820968628, 6488227843],
        pearl: [0, 10, 20, 40, 80, 160, 320, 640, 1280, 2560, 5120, 10240, 20480, 40960, 81920, 163840, 327680, 655360, 1310720, 2621440]
    },

    // èŠ±ç“£ä½“ä¼¤æ•°æ® (1-19çº§)
    BODY_DAMAGE: {
        missile: [0, 30, 90, 270, 810, 2430, 7290, 21870, 65610, 196830, 590490, 1771470, 5314410, 15943230, 47829690, 143489070, 430467210, 1291401630, 3874204890, 11622614670],
        basic: [0, 10, 30, 90, 270, 810, 2430, 7290, 21870, 65610, 196830, 590490, 1771470, 5314410, 15943230, 47829690, 143489070, 430467210, 1291401630, 3874204890],
        leaf: [0, 10, 30, 90, 270, 810, 2430, 7290, 21870, 65610, 196830, 590490, 1771470, 5314410, 15943230, 47829690, 143489070, 430467210, 1291401630, 3874204890],
        wing: [0, 13, 39, 117, 351, 1053, 3159, 9477, 28431, 85293, 255879, 767637, 2302911, 6908733, 20726199, 62178597, 186535791, 559607373, 1678822119, 5036466357],
        thunder: [0, 13, 40, 120, 360, 1080, 3240, 9720, 29160, 87480, 262440, 787320, 2361960, 7085880, 21257640, 63772920, 191318760, 573956280, 1721868840, 5165606520],
        venom: [0, 8, 24, 72, 216, 648, 1944, 5832, 17496, 52488, 157464, 472392, 1417176, 4251528, 12754584, 38263752, 114791256, 344373768, 1033121304, 3099363912],
        shield: [0, 5, 15, 45, 135, 405, 1215, 3645, 10935, 32805, 98415, 295245, 885735, 2657205, 7971615, 23914845, 71744535, 215233605, 645700815, 1937102445],
        bomb: [0, 25, 75, 225, 675, 2025, 6075, 18225, 54675, 164025, 492075, 1476225, 4428675, 13286025, 39858075, 119574225, 358722675, 1076168025, 3228504075, 9685512225],
        hornet_missile: [0, 10, 30, 90, 270, 810, 2430, 8290, 24870, 74610, 223830, 671490, 2014470, 6043410, 18130230, 54390690, 163172070, 489516210, 1468548630, 4405645890],
        magnet: [0, 8, 24, 72, 216, 648, 1944, 5832, 17496, 52488, 157464, 472392, 1417176, 4251528, 12754584, 38263752, 114791256, 344373768, 1033121304, 3099363912],
        thirdeye: [0, 12, 36, 108, 324, 972, 2916, 8748, 26244, 78732, 236196, 708588, 2125764, 6377292, 19131876, 57395628, 172186884, 516560652, 1549681956, 4649045868],
        stinger: [0, 81, 243, 729, 2187, 6561, 19683, 59049, 177147, 531441, 1594323, 4782969, 14348907, 43046721, 129140163, 387420489, 1162261467, 3486784401, 10460353203, 31381059609],
        orange: [0, 22, 65, 194, 583, 1750, 5249, 15746, 47239, 141718, 425153, 1275458, 3826375, 11479126, 34437370, 103312131, 309936391, 929809174, 2789427521, 8368282562],
        egg: [0, 10, 30, 90, 270, 810, 2430, 7290, 21870, 65610, 196830, 590490, 1771470, 5314410, 15943230, 47829690, 143489070, 430467210, 1291401630, 3874204890],
        square: [0, 1, 3, 9, 27, 81, 243, 729, 2187, 6561, 19683, 59049, 177147, 531441, 1594323, 4782969, 14348907, 43046721, 129140163, 387420489],
        pearl: [0, 24, 72, 216, 648, 1944, 5832, 17496, 52488, 157464, 472392, 1417176, 4251528, 12754584, 38263752, 114791256, 344373768, 1033121304, 3099363912, 9298091736]
    },

    // èŠ±ç“£å›è¡€æ•°æ® (1-19çº§ï¼Œå¤§éƒ¨åˆ†ä¸º0)
    HEAL: {
        missile: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        basic: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        leaf: [0, 25, 50, 100, 200, 400, 800, 1600, 3200, 6400, 12800, 25600, 51200, 102400, 204800, 409600, 819200, 1638400, 3276800, 6553600],
        wing: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        thunder: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        venom: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        shield: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        bomb: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        hornet_missile: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        magnet: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        thirdeye: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        stinger: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        orange: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        egg: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        square: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        pearl: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    },

    // èŠ±ç“£é‡é‡æ•°æ® (1-19çº§)
    WEIGHT: {
        missile: [0, 1, 3, 9, 27, 81, 243, 829, 2487, 7461, 22383, 67149, 201447, 604341, 1813023, 5439069, 16317207, 48951621, 146854863, 440564589],
        basic: [0, 1, 3, 9, 27, 81, 243, 829, 2487, 7461, 22383, 67149, 201447, 604341, 1813023, 5439069, 16317207, 48951621, 146854863, 440564589],
        leaf: [0, 1, 3, 9, 27, 81, 243, 829, 2487, 7461, 22383, 67149, 201447, 604341, 1813023, 5439069, 16317207, 48951621, 146854863, 440564589],
        wing: [0, 1, 3, 9, 27, 81, 243, 829, 2487, 7461, 22383, 67149, 201447, 604341, 1813023, 5439069, 16317207, 48951621, 146854863, 440564589],
        thunder: [0, 3, 9, 27, 81, 243, 729, 2187, 6561, 19683, 59049, 177147, 531441, 1594323, 4782969, 14348907, 43046721, 129140163, 387420489, 1162261467],
        venom: [0, 2, 6, 18, 54, 162, 486, 1458, 4374, 13122, 39366, 118098, 354294, 1062882, 3188646, 9565938, 28697814, 86093442, 258280326, 774840978],
        shield: [0, 4, 12, 36, 108, 324, 972, 2916, 8748, 26244, 78732, 236196, 708588, 2125764, 6377292, 19131876, 57395628, 172186884, 516560652, 1549681956],
        bomb: [0, 5, 15, 45, 135, 405, 1215, 3645, 10935, 32805, 98415, 295245, 885735, 2657205, 7971615, 23914845, 71744535, 215233605, 645700815, 1937102445],
        hornet_missile: [0, 10, 30, 90, 270, 810, 2430, 8290, 24870, 74610, 223830, 671490, 2014470, 6043410, 18130230, 54390690, 163172070, 489516210, 1468548630, 4405645890],
        magnet: [0, 2, 6, 18, 54, 162, 486, 1458, 4374, 13122, 39366, 118098, 354294, 1062882, 3188646, 9565938, 28697814, 86093442, 258280326, 774840978],
        thirdeye: [0, 3, 9, 27, 81, 243, 729, 2187, 6561, 19683, 59049, 177147, 531441, 1594323, 4782969, 14348907, 43046721, 129140163, 387420489, 1162261467],
        stinger: [0, 2, 6, 18, 54, 162, 486, 1458, 4374, 13122, 39366, 118098, 354294, 1062882, 3188646, 9565938, 28697814, 86093442, 258280326, 774840978],
        orange: [0, 2, 6, 18, 54, 162, 486, 1458, 4374, 13122, 39366, 118098, 354294, 1062882, 3188646, 9565938, 28697814, 86093442, 258280326, 774840978],
        egg: [0, 3, 9, 27, 81, 243, 729, 2187, 6561, 19683, 59049, 177147, 531441, 1594323, 4782969, 14348907, 43046721, 129140163, 387420489, 1162261467],
        square: [0, 1, 3, 9, 27, 81, 243, 829, 2487, 7461, 22383, 67149, 201447, 604341, 1813023, 5439069, 16317207, 48951621, 146854863, 440564589],
        pearl: [0, 2, 6, 18, 54, 162, 486, 1458, 4374, 13122, 39366, 118098, 354294, 1062882, 3188646, 9565938, 28697814, 86093442, 258280326, 774840978]
    },

    // ç‰¹æ®Šæœºåˆ¶æ•°æ®
    SPECIAL_MECHANICS: {
        missile: {
            range: 200,  // å‘å°„è·ç¦»
            speed: 10,    // é£è¡Œé€Ÿåº¦
            type: 'projectile'  // æŠ•å°„ç‰©ç±»å‹
        },
        basic: {
            type: 'melee'  // è¿‘æˆ˜ç±»å‹
        },
        leaf: {
            heal_type: 'passive',  // è¢«åŠ¨å›è¡€
            type: 'melee'
        },
        wing: {
            range: 300,     // æœ€å¤§é£è¡Œè·ç¦»
            type: 'special', // ç‰¹æ®Šé£è¡Œè½¨è¿¹
            sine_pattern: true  // æ­£å¼¦æ³¢é£è¡Œæ¨¡å¼
        },
        thunder: {
            chain_range: 150,      // è¿é”èŒƒå›´åŸºæ•°
            chain_by_level: {
                1: 5, 2: 5, 3: 5, 4: 5, 5: 5, 6: 5,      // 1-6çº§ï¼š5ä¸ªè¿é”
                7: 6, 8: 6, 9: 6, 10: 6, 11: 6, 12: 6,  // 7-12çº§ï¼š6ä¸ªè¿é”
                13: 7, 14: 7, 15: 7, 16: 7, 17: 7, 18: 7, 19: 7  // 13-19çº§ï¼š7ä¸ªè¿é”
            },
            chain_damage_factor: 0.5, // è¿é”ä¼¤å®³è¡°å‡ç³»æ•°
            type: 'chain'          // è¿é”é—ªç”µ
        },
        venom: {
            poison_duration: 3.0,   // ä¸­æ¯’æŒç»­æ—¶é—´(ç§’)
            poison_damage_factor: 1.0, // ä¸­æ¯’ä¼¤å®³ç³»æ•°ï¼šä½“ä¼¤çš„100%
            type: 'poison'         // æ¯’æ¶²æ•ˆæœ
        },
        shield: {
            fire_interval: 3.0,     // å‘å°„é—´éš”(ç§’)
            pearls_per_fire: 3,     // æ¯æ¬¡å‘å°„çš„çç æ•°é‡
            pearl_level_penalty: 1, // çç ç­‰çº§é™ä½æ•°
            fire_angle_spread: 30,  // å‘å°„è§’åº¦æ‰©æ•£èŒƒå›´(åº¦)
            type: 'auto_turret'     // è‡ªåŠ¨ç‚®å¡”ç±»å‹
        },
        bomb: {
            explosion_radius: 100,  // åŸºç¡€çˆ†ç‚¸åŠå¾„
            radius_per_level: 50,   // æ¯çº§å¢åŠ åŠå¾„
            explosion_damage_factor: 2, // çˆ†ç‚¸ä¼¤å®³å€æ•°
            type: 'explosion'       // çˆ†ç‚¸ç±»å‹
        },
        hornet_missile: {
            speed_factor: 2,        // é€Ÿåº¦å€æ•°
            range: 200,             // é£è¡Œè·ç¦»
            type: 'homing'          // è¿½è¸ªå¯¼å¼¹
        },
        magnet: {
            pickup_range_bonus: 100, // åŸºç¡€æ‹¾å–èŒƒå›´åŠ æˆ
            pickup_range_per_level: 50, // æ¯çº§å¢åŠ èŒƒå›´
            base_pickup_range: 50,   // åŸºç¡€æ‹¾å–èŒƒå›´
            type: 'utility'          // åŠŸèƒ½å‹
        },
        thirdeye: {
            orbit_radius_bonus: 20,  // åŸºç¡€å…¬è½¬åŠå¾„åŠ æˆ
            orbit_radius_per_level: 18, // æ¯çº§å¢åŠ åŠå¾„
            base_orbit_radius: 80,   // åŸºç¡€å…¬è½¬åŠå¾„
            type: 'utility'          // åŠŸèƒ½å‹
        },
        stinger: {
            multi_entity: true,      // å¤šå•ä½“
            independent_cooldown: true, // ç‹¬ç«‹å†·å´
            type: 'multi_projectile' // å¤šæŠ•å°„ç‰©
        },
        orange: {
            multi_entity: true,      // å¤šå•ä½“
            independent_cooldown: true, // ç‹¬ç«‹å†·å´
            type: 'multi_projectile' // å¤šæŠ•å°„ç‰©
        },
        egg: {
            hatch_time: 5.0,         // å­µåŒ–æ—¶é—´(ç§’)
            cooldown_time: 2.0,      // å†·å´æ—¶é—´(ç§’)
            max_beetles: 3,          // æœ€å¤§ç”²è™«æ•°é‡
            type: 'spawner'          // å¬å”¤ç±»å‹
        },
        square: {
            shield_duration: 20,     // æŠ¤ç›¾æŒç»­æ—¶é—´(ç§’)
            shield_cooldown: 1.0,    // æŠ¤ç›¾å†·å´æ—¶é—´(ç§’)
            shield_health_factor: 2,  // æŠ¤ç›¾è¡€é‡å€æ•°
            size_multiplier: 7,      // æ¿€æ´»æ—¶å¤§å°å€æ•°
            radius_multiplier: 8,    // æ¿€æ´»æ—¶åŠå¾„å€æ•°
            weight_multiplier: 999999999, // æ¿€æ´»æ—¶é‡é‡
            type: 'shield'           // æŠ¤ç›¾ç±»å‹
        },
        pearl: {
            range: 250,              // å‘å°„è·ç¦»
            speed: 10,               // é£è¡Œé€Ÿåº¦
            type: 'projectile'       // æŠ•å°„ç‰©ç±»å‹
        }
    },

    /**
     * è·å–èŠ±ç“£æ•°æ®
     * @param {string|number} petalType èŠ±ç“£ç±»å‹(åç§°æˆ–ç´¢å¼•)
     * @param {number} level èŠ±ç“£ç­‰çº§ (1-19)
     * @returns {object} èŠ±ç“£å®Œæ•´æ•°æ®
     */
    getPetalData(petalType, level = 1) {
        // å¤„ç†ç´¢å¼•åˆ°åç§°çš„è½¬æ¢
        if (typeof petalType === 'number') {
            petalType = this.TYPE_MAP[petalType];
        }

        if (!petalType || !this.NAMES[petalType]) {
            return null;
        }

        // ç¡®ä¿ç­‰çº§åœ¨æœ‰æ•ˆèŒƒå›´å†…
        level = Math.max(1, Math.min(19, level));

        return {
            type: petalType,
            name: this.NAMES[petalType],
            description: this.DESCRIPTIONS[petalType],
            cooldown: this.COOLDOWNS[petalType],
            health: this.HEALTH[petalType][level],
            bodyDamage: this.BODY_DAMAGE[petalType][level],
            heal: this.HEAL[petalType][level],
            weight: this.WEIGHT[petalType][level],
            level: level,
            mechanics: this.SPECIAL_MECHANICS[petalType] || {},
            hasHeal: this.HEAL[petalType][level] > 0
        };
    },

    /**
     * è·å–æ‰€æœ‰èŠ±ç“£ç±»å‹çš„åˆ—è¡¨
     * @returns {array} èŠ±ç“£ç±»å‹æ•°ç»„
     */
    getAllPetalTypes() {
        return Object.keys(this.NAMES);
    },

    /**
     * è·å–èŠ±ç“£ç­‰çº§åˆ—è¡¨
     * @returns {array} ç­‰çº§æ•°ç»„ (1-19)
     */
    getPetalLevels() {
        return Array.from({length: 19}, (_, i) => i + 1);
    },

    /**
     * æ ¹æ®ç´¢å¼•è·å–èŠ±ç“£åç§°
     * @param {number} index èŠ±ç“£ç´¢å¼•
     * @returns {string} èŠ±ç“£åç§°
     */
    getPetalNameByIndex(index) {
        const type = this.TYPE_MAP[index];
        return type ? this.NAMES[type] : 'Unknown';
    },

    /**
     * æ ¼å¼åŒ–æ•°å­—æ˜¾ç¤º
     * @param {number} num è¦æ ¼å¼åŒ–çš„æ•°å­—
     * @returns {string} æ ¼å¼åŒ–åçš„å­—ç¬¦ä¸²
     */
    formatNumber(num) {
        if (num >= 1000000000) {
            return (num / 1000000000).toFixed(1) + 'B';
        } else if (num >= 1000000) {
            return (num / 1000000).toFixed(1) + 'M';
        } else if (num >= 1000) {
            return (num / 1000).toFixed(1) + 'K';
        }
        return num.toString();
    },

    /**
     * è·å–èŠ±ç“£å±æ€§æ–‡æœ¬æè¿°
     * @param {string|number} petalType èŠ±ç“£ç±»å‹
     * @param {number} level èŠ±ç“£ç­‰çº§
     * @returns {object} æ ¼å¼åŒ–çš„å±æ€§æ–‡æœ¬
     */
    getPetalStatsText(petalType, level = 1) {
        const data = this.getPetalData(petalType, level);
        if (!data) return null;

        const stats = [];

        // è¡€é‡
        stats.push(`â¤ï¸ è¡€é‡: ${this.formatNumber(data.health)}`);

        // ä½“ä¼¤
        stats.push(`âš”ï¸ ä¼¤å®³: ${this.formatNumber(data.bodyDamage)}`);

        // é‡é‡
        stats.push(`âš–ï¸ é‡é‡: ${this.formatNumber(data.weight)}`);

        // å›è¡€ (å¦‚æœå¤§äº0)
        if (data.hasHeal) {
            stats.push(`ğŸ’š å›è¡€: ${this.formatNumber(data.heal)}`);
        }

        // å†·å´æ—¶é—´
        if (data.cooldown !== null) {
            stats.push(`â±ï¸ å†·å´: ${data.cooldown}ç§’`);
        } else {
            stats.push(`â±ï¸ å†·å´: ç‰¹æ®Šæœºåˆ¶`);
        }

        // æ·»åŠ ç‰¹æ®Šæœºåˆ¶è¯¦ç»†ä¿¡æ¯
        const mechanics = data.mechanics;
        if (mechanics) {
            switch (data.type) {
                case 'missile':
                    stats.push(`ğŸ¯ å°„ç¨‹: ${mechanics.range}px`);
                    stats.push(`ğŸ’¨ é€Ÿåº¦: ${mechanics.speed}`);
                    break;

                case 'pearl':
                    stats.push(`ğŸ¯ å°„ç¨‹: ${mechanics.range}px`);
                    stats.push(`ğŸ’¨ é€Ÿåº¦: ${mechanics.speed}`);
                    break;

                case 'wing':
                    stats.push(`ğŸŒ€ æœ€å¤§è·ç¦»: ${mechanics.range}px`);
                    break;

                case 'thunder':
                    const chainRange = 100 + level * 25;
                    const maxChains = mechanics.chain_by_level[level] || 5;
                    stats.push(`âš¡ è¿é”èŒƒå›´: ${chainRange}px`);
                    stats.push(`ğŸ”— æœ€å¤§è¿é”: ${maxChains}ä¸ª`);
                    stats.push(`ğŸ“‰ ä¼¤å®³è¡°å‡: ${mechanics.chain_damage_factor * 100}%`);
                    break;

                case 'venom':
                    stats.push(`â˜ ï¸ ä¸­æ¯’æŒç»­: ${mechanics.poison_duration}ç§’`);
                    stats.push(`ğŸ©¸ æ¯ç§’ä¼¤å®³: ä¼¤å®³${(mechanics.poison_damage_factor * 100)}%`);
                    break;

                case 'shield':
                    stats.push(`ğŸ”« å‘å°„é—´éš”: ${mechanics.fire_interval}ç§’`);
                    stats.push(`âšª æ¯æ¬¡å‘å°„: ${mechanics.pearls_per_fire}ä¸ªçç `);
                    stats.push(`ğŸ“‰ çç ç­‰çº§: ${Math.max(1, level - mechanics.pearl_level_penalty)}çº§`);
                    stats.push(`ğŸ¯ å‘å°„è§’åº¦: Â±${mechanics.fire_angle_spread}Â°`);
                    break;

                case 'square':
                    stats.push(`ğŸ›¡ï¸ æŠ¤ç›¾æŒç»­: ${mechanics.shield_duration}ç§’`);
                    stats.push(`ğŸ”„ æŠ¤ç›¾å†·å´: ${mechanics.shield_cooldown}ç§’`);
                    stats.push(`ğŸ’ª æŠ¤ç›¾è¡€é‡: ${mechanics.shield_health_factor}x`);
                    break;

                case 'bomb':
                    const explosionRadius = mechanics.explosion_radius + mechanics.radius_per_level * level;
                    stats.push(`ğŸ’¥ çˆ†ç‚¸åŠå¾„: ${explosionRadius}px`);
                    stats.push(`ğŸ”¥ çˆ†ç‚¸ä¼¤å®³: ${mechanics.explosion_damage_factor}x`);
                    break;

                case 'hornet_missile':
                    stats.push(`ğŸ¯ è¿½è¸ªå¯¼å¼¹`);
                    stats.push(`ğŸ’¨ é€Ÿåº¦å€æ•°: ${mechanics.speed_factor}x`);
                    stats.push(`ğŸ“ å°„ç¨‹: ${mechanics.range}px`);
                    break;

                case 'magnet':
                    const pickupRange = mechanics.pickup_range_bonus + mechanics.pickup_range_per_level * level;
                    const totalRange = pickupRange + mechanics.base_pickup_range;
                    stats.push(`ğŸ§² æ‹¾å–èŒƒå›´: +${totalRange}px`);
                    break;

                case 'thirdeye':
                    const orbitRadius = mechanics.orbit_radius_bonus + mechanics.orbit_radius_per_level * level;
                    const totalOrbitRadius = orbitRadius + mechanics.base_orbit_radius;
                    stats.push(`ğŸ‘ï¸ å…¬è½¬åŠå¾„: +${totalOrbitRadius}px`);
                    break;

                case 'stinger':
                case 'orange':
                    break;

                case 'egg':
                    stats.push(`ğŸ¥š å­µåŒ–æ—¶é—´: ${mechanics.hatch_time}ç§’`);
                    stats.push(`â±ï¸ å†·å´æ—¶é—´: ${mechanics.cooldown_time}ç§’`);
                    stats.push(`ğŸª° æœ€å¤§ç”²è™«: ${mechanics.max_beetles}åª`);
                    break;

                case 'leaf':
                    break;

                case 'basic':
                    break;
            }
        }

        return {
            stats: stats,
            mechanics: data.mechanics
        };
    }
};

// å¯¼å‡ºåˆ°å…¨å±€ä½œç”¨åŸŸï¼Œæ–¹ä¾¿å‰ç«¯è°ƒç”¨
if (typeof module !== 'undefined' && module.exports) {
    module.exports = PETALS_DATA;
} else {
    window.PETALS_DATA = PETALS_DATA;
}