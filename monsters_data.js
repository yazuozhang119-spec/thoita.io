// æ€ªç‰©æ•°æ®ç»“æ„ - åŸºäºgame_engine.pyä¸­allMobsæ•°ç»„å’Œmobs.pyçš„çœŸå®æ•°æ®
// 15ç§æ€ªç‰©çš„è¯¦ç»†ä¿¡æ¯ã€æ‰è½ã€å±æ€§ç­‰ï¼Œæ”¯æŒ1-25çº§

// èŠ±ç“£åç§°æ˜ å°„ - åŸºäºæ¸¸æˆæ•°æ®
const PETAL_NAMES = {
    0: 'å¯¼å¼¹',
    1: 'åŸºç¡€',
    2: 'å¡ç‰‡',
    3: 'å¶å­',
    4: 'ç¿…è†€',
    5: 'é›·ç”µ',
    6: 'æ¯’æ¶²',
    7: 'ç›¾ç‰Œ',
    8: 'ç‚¸å¼¹',
    9: 'ç£é“',
    10: 'ç¬¬ä¸‰çœ¼',
    11: 'é»„èœ‚å¯¼å¼¹',
    12: 'çç ',
    13: 'çˆ†ç‚¸',
    15: 'èš‚èšè›‹',
    16: 'é»„èœ‚',
    17: 'ç£é“',
    18: 'ç¬¬ä¸‰çœ¼',
    19: 'å¶å­'
};

// æ€ªç‰©æ•°æ® - åŸºäºgame_engine.pyä¸­allMobsæ•°ç»„ (15ç§æ€ªç‰©ï¼Œ1-25çº§)
// allMobsæ•°ç»„æ ¼å¼: [name, health[0-25], bodyDamage[0-25], weight[0-25]]
const MONSTER_DATA = {
    hornet: {
        name: 'é»„èœ‚',
        description: 'å¿«é€Ÿç§»åŠ¨çš„é£è¡Œæ€ªç‰©ï¼Œå‘å°„ç›´çº¿è¿½è¸ªçš„å­å¼¹',
        // è¡€é‡æ•°æ® (level 1-25)
        health: [60, 180, 540, 1620, 4860, 14580, 43740, 131220, 393660, 1180980, 3542940, 10628820, 31886460, 95659380, 286978140, 860934420, 2582803260, 7748409780, 23245229340, 69735688020, 209207064060, 627621192180, 1882863576540, 5648590729620, 16945772188860],
        // ä½“ä¼¤æ•°æ®
        bodyDamage: [7, 15, 30, 60, 120, 240, 480, 960, 1920, 3840, 7680, 15360, 30720, 61440, 122880, 245760, 491520, 983040, 1966080, 3932160, 7864320, 15728640, 31457280, 62914560, 125829120],
        // é‡é‡æ•°æ®
        weight: [30, 90, 270, 810, 2430, 7290, 21870, 65610, 196830, 590490, 1771470, 5314410, 15943230, 47829690, 143489070, 430467210, 1291401630, 3874204890, 11622614670, 34867844010, 104603532030, 313810596090, 941431788270, 2824295364810, 8472886094430],
        drops: [0, 12], // å¯¼å¼¹å’Œé»„èœ‚å¯¼å¼¹
        rarity: 'common',
        behaviors: ['è¿½è¸ª', 'å°„å‡»', 'é£è¡Œ'],
        icon: 'ğŸ',
        maxLevel: 25
    },
    rock: {
        name: 'å²©çŸ³',
        description: 'ç¼“æ…¢ç§»åŠ¨çš„é˜²å¾¡å‹æ€ªç‰©ï¼Œé«˜ç”Ÿå‘½å€¼ä½†é€Ÿåº¦å¾ˆæ…¢ï¼Œé™æ­¢ä¸ç§»åŠ¨',
        health: [105, 315, 945, 2835, 8505, 25515, 76545, 229635, 688905, 2066715, 6200145, 18600435, 55801305, 167403915, 502211745, 1506635235, 4519905705, 13559717115, 40679151345, 122037454035, 366112362105, 1098337086315, 3295011258945, 9885033776835, 29655101330505],
        bodyDamage: [2, 5, 10, 20, 40, 80, 160, 320, 640, 1280, 2560, 5120, 10240, 20480, 40960, 81920, 163840, 327680, 655360, 1310720, 2621440, 5242880, 10485760, 20971520, 41943040],
        weight: [45, 135, 405, 1215, 3645, 10935, 32805, 98415, 295245, 885735, 2657205, 7971615, 23914845, 71744535, 215233605, 645700815, 1937102445, 5811307335, 17433922005, 52301766015, 156905298045, 470715894135, 1412147682405, 4236443047215, 12709329141645],
        drops: [1, 1], // åŸºç¡€èŠ±ç“£
        rarity: 'common',
        behaviors: ['é˜²å¾¡', 'ç¼“æ…¢', 'å¦å…‹', 'é™æ­¢'],
        icon: 'ğŸª¨',
        maxLevel: 25
    },
    ladybug: {
        name: 'ç“¢è™«',
        description: 'ä¸­ç­‰é€Ÿåº¦çš„åœ°é¢æ€ªç‰©ï¼Œä¼šè¿›è¡ŒçŸ­è·ç¦»å†²åˆº',
        health: [54, 162, 486, 1458, 4374, 13122, 39366, 118098, 354294, 1062882, 3188646, 9565938, 28697814, 86093442, 258280326, 774840978, 2324522934, 6973568802, 20920706406, 62762119218, 188286357654, 564859072962, 1694577218886, 5083731656658, 15251194969974],
        bodyDamage: [4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 65536, 131072, 262144, 524288, 1048576, 2097152, 4194304, 8388608, 16777216, 33554432, 67108864],
        weight: [36, 108, 324, 972, 2916, 8748, 26244, 78732, 236196, 708588, 2125764, 6377292, 19131876, 57395628, 172186884, 516560652, 1549681956, 4649045868, 13947137604, 41841412812, 125524238436, 376572715308, 1129718145924, 3389154437772, 10167463313316],
        drops: [4, 11], // ç¿…è†€
        rarity: 'common',
        behaviors: ['å†²åˆº', 'åœ°é¢', 'ä¸­ç­‰é€Ÿåº¦'],
        icon: 'ğŸ',
        maxLevel: 25
    },
    centipede: {
        name: 'èœˆèš£',
        description: 'é•¿å½¢åˆ†æ®µæ€ªç‰©ï¼Œç§»åŠ¨æ—¶å‘ˆæ³¢æµªçŠ¶ï¼Œç”±6-10ä¸ªèŠ‚æ®µç»„æˆ',
        health: [75, 225, 675, 2025, 6075, 18225, 54675, 164025, 492075, 1476225, 4428675, 13286025, 39858075, 119574225, 358722675, 1076168025, 3228504075, 9685512225, 29056536675, 87169610025, 261508830075, 784526490225, 2353579470675, 7060738412025, 21182215236075],
        bodyDamage: [1.5, 3, 6, 12, 24, 48, 96, 192, 384, 768, 1536, 3072, 6144, 12288, 24576, 49152, 98304, 196608, 393216, 786432, 1572864, 3145728, 6291456, 12582912, 25165824],
        weight: [24, 72, 216, 648, 1944, 5832, 17496, 52488, 157464, 472392, 1417176, 4251528, 12754584, 38263752, 114791256, 344373768, 1033121304, 3099363912, 9298091736, 27894275208, 83682825624, 251048476872, 753145430616, 2259436291848, 6778308875544],
        drops: [3], // å¶å­
        rarity: 'uncommon',
        behaviors: ['åˆ†æ®µ', 'æ³¢æµªç§»åŠ¨', 'é•¿å½¢'],
        icon: 'ğŸ›',
        maxLevel: 25
    },
    thunderelement: {
        name: 'é›·ç”µå…ƒç´ ',
        description: 'å‘å°„é›·ç”µå¼¹çš„å…ƒç´ æ€ªç‰©ï¼Œæ”»å‡»å¸¦è¿é”æ•ˆæœ',
        health: [90, 270, 810, 2430, 7290, 21870, 65610, 196830, 590490, 1771470, 5314410, 15943230, 47829690, 143489070, 430467210, 1291401630, 3874204890, 11622614670, 34867844010, 104603532030, 313810596090, 941431788270, 2824295364810, 8472886094430, 25418658283290],
        bodyDamage: [6, 12, 24, 48, 96, 192, 384, 768, 1536, 3072, 6144, 12288, 24576, 49152, 98304, 196608, 393216, 786432, 1572864, 3145728, 6291456, 12582912, 25165824, 50331648, 100663296],
        weight: [45, 135, 405, 1215, 3645, 10935, 32805, 98415, 295245, 885735, 2657205, 7971615, 23914845, 71744535, 215233605, 645700815, 1937102445, 5811307335, 17433922005, 52301766015, 156905298045, 470715894135, 1412147682405, 4236443047215, 12709329141645],
        drops: [5], // é›·ç”µèŠ±ç“£
        rarity: 'rare',
        behaviors: ['è¿é”æ”»å‡»', 'å…ƒç´ ', 'è¿œç¨‹'],
        icon: 'âš¡',
        maxLevel: 25
    },
    venomspider: {
        name: 'æ¯’èœ˜è››',
        description: 'å‘å°„æ¯’æ¶²å¼¹çš„æ€ªç‰©ï¼Œé€ æˆæŒç»­ä¼¤å®³',
        health: [66, 198, 594, 1782, 5346, 16038, 48114, 144342, 433026, 1299078, 3897234, 11691702, 35075106, 105225318, 315675954, 947027862, 2841083586, 8523250758, 25569752274, 76709256822, 230127770466, 690383311398, 2071149934194, 6213449802582, 18640349407746],
        bodyDamage: [3, 6, 12, 24, 48, 96, 192, 384, 768, 1536, 3072, 6144, 12288, 24576, 49152, 98304, 196608, 393216, 786432, 1572864, 3145728, 6291456, 12582912, 25165824, 50331648],
        weight: [30, 90, 270, 810, 2430, 7290, 21870, 65610, 196830, 590490, 1771470, 5314410, 15943230, 47829690, 143489070, 430467210, 1291401630, 3874204890, 11622614670, 34867844010, 104603532030, 313810596090, 941431788270, 2824295364810, 8472886094430],
        drops: [6, 10], // æ¯’æ¶²å’Œä¸‰çœ¼èŠ±ç“£
        rarity: 'rare',
        behaviors: ['æ¯’ä¼¤', 'æŒç»­ä¼¤å®³', 'èœ˜è››'],
        icon: 'ğŸ•·ï¸',
        maxLevel: 25
    },
    shieldguardian: {
        name: 'ç›¾å«',
        description: 'é«˜é˜²å¾¡æ€ªç‰©ï¼Œèƒ½æŠµæŒ¡ä¸€å®šæ•°é‡çš„æ”»å‡»ï¼Œå¯è·³è·ƒç§»åŠ¨',
        health: [120, 360, 1080, 3240, 9720, 29160, 87480, 262440, 787320, 2361960, 7085880, 21257640, 63772920, 191318760, 573956280, 1721868840, 5165606520, 15496819560, 46490458680, 139471376040, 418414128120, 1255242384360, 3765727153080, 11297181459240, 33891544377720],
        bodyDamage: [4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 65536, 131072, 262144, 524288, 1048576, 2097152, 4194304, 8388608, 16777216, 33554432, 67108864],
        weight: [60, 180, 540, 1620, 4860, 14580, 43740, 131220, 393660, 1180980, 3542940, 10628820, 31886460, 95659380, 286978140, 860934420, 2582803260, 7748409780, 23245229340, 69735688020, 209207064060, 627621192180, 1882863576540, 5648590729620, 16945772188860],
        drops: [7, 9], // æŠ¤ç›¾èŠ±ç“£
        rarity: 'rare',
        behaviors: ['æ ¼æŒ¡', 'é˜²å¾¡', 'é‡è£…', 'è·³è·ƒ'],
        icon: 'ğŸ›¡ï¸',
        maxLevel: 25
    },
    bombbeetle: {
        name: 'ç‚¸å¼¹ç”²è™«',
        description: 'è‡ªçˆ†å‹æ€ªç‰©ï¼Œæ­»äº¡æ—¶é€ æˆèŒƒå›´ä¼¤å®³',
        health: [60, 180, 540, 1620, 4860, 14580, 43740, 131220, 393660, 1180980, 3542940, 10628820, 31886460, 95659380, 286978140, 860934420, 2582803260, 7748409780, 23245229340, 69735688020, 209207064060, 627621192180, 1882863576540, 5648590729620, 16945772188860],
        bodyDamage: [7, 15, 30, 60, 120, 240, 480, 960, 1920, 3840, 7680, 15360, 30720, 61440, 122880, 245760, 491520, 983040, 1966080, 3932160, 7864320, 15728640, 31457280, 62914560, 125829120],
        weight: [24, 72, 216, 648, 1944, 5832, 17496, 52488, 157464, 472392, 1417176, 4251528, 12754584, 38263752, 114791256, 344373768, 1033121304, 3099363912, 9298091736, 27894275208, 83682825624, 251048476872, 753145430616, 2259436291848, 6778308875544],
        drops: [13, 8], // çˆ†ç‚¸èŠ±ç“£
        rarity: 'epic',
        behaviors: ['è‡ªçˆ†', 'èŒƒå›´ä¼¤å®³', 'è‡ªæ€æ”»å‡»'],
        icon: 'ğŸ’£',
        maxLevel: 25
    },
    soldierant: {
        name: 'å…µèš',
        description: 'èš‚èšæ—ç¾¤ä¸­çš„æˆ˜å£«ï¼Œæ”»å‡»æ€§å¼ºï¼Œå¿«é€Ÿç§»åŠ¨',
        health: [72, 216, 648, 1944, 5832, 17496, 52488, 157464, 472392, 1417176, 4251528, 12754584, 38263752, 114791256, 344373768, 1033121304, 3099363912, 9298091736, 27894275208, 83682825624, 251048476872, 753145430616, 2259436291848, 6778308875544, 20334926626632],
        bodyDamage: [2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 65536, 131072, 262144, 524288, 1048576, 2097152, 4194304, 8388608, 16777216, 33554432],
        weight: [42, 126, 378, 1134, 3402, 10206, 30618, 91854, 275562, 826686, 2480058, 7440174, 22320522, 66961566, 200884698, 602654094, 1807962282, 5423886846, 16271660538, 48814981614, 146444944842, 439334834526, 1318004503578, 3954013510734, 11862040532202],
        drops: [3, 7], // å¶å­å’ŒæŠ¤ç›¾èŠ±ç“£
        rarity: 'uncommon',
        behaviors: ['æ”»å‡»æ€§', 'ç¾¤ä½“', 'æˆ˜å£«', 'å¿«é€Ÿ'],
        icon: 'ğŸœ',
        maxLevel: 25
    },
    workerant: {
        name: 'å·¥èš',
        description: 'èš‚èšæ—ç¾¤ä¸­çš„å·¥ä½œè€…',
        health: [60, 180, 540, 1620, 4860, 14580, 43740, 131220, 393660, 1180980, 3542940, 10628820, 31886460, 95659380, 286978140, 860934420, 2582803260, 7748409780, 23245229340, 69735688020, 209207064060, 627621192180, 1882863576540, 5648590729620, 16945772188860],
        bodyDamage: [2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 65536, 131072, 262144, 524288, 1048576, 2097152, 4194304, 8388608, 16777216, 33554432],
        weight: [30, 90, 270, 810, 2430, 7290, 21870, 65610, 196830, 590490, 1771470, 5314410, 15943230, 47829690, 143489070, 430467210, 1291401630, 3874204890, 11622614670, 34867844010, 104603532030, 313810596090, 941431788270, 2824295364810, 8472886094430],
        drops: [1, 3], // åŸºç¡€èŠ±ç“£å’Œå¶å­
        rarity: 'common',
        behaviors: ['å·¥ä½œ', 'åœ°é¢'],
        icon: 'ğŸœ',
        maxLevel: 25
    },
    babyant: {
        name: 'å¹¼èš',
        description: 'èš‚èšæ—ç¾¤ä¸­çš„å¹¼ä½“ï¼Œå’Œå¹³ç”Ÿç‰©ä¸æ”»å‡»ç©å®¶',
        health: [30, 90, 270, 810, 2430, 7290, 21870, 65610, 196830, 590490, 1771470, 5314410, 15943230, 47829690, 143489070, 430467210, 1291401630, 3874204890, 11622614670, 34867844010, 104603532030, 313810596090, 941431788270, 2824295364810, 8472886094430],
        bodyDamage: [2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 65536, 131072, 262144, 524288, 1048576, 2097152, 4194304, 8388608, 16777216, 33554432],
        weight: [20, 60, 180, 540, 1620, 4860, 14580, 43740, 131220, 393660, 1180980, 3542940, 10628820, 31886460, 95659380, 286978140, 860934420, 2582803260, 7748409780, 23245229340, 69735688020, 209207064060, 627621192180, 1882863576540, 5648590729620],
        drops: [1, 3], // åŸºç¡€èŠ±ç“£å’Œç¿…è†€
        rarity: 'common',
        behaviors: ['å¹¼ä½“', 'å’Œå¹³', 'ç¼“æ…¢'],
        icon: 'ğŸœ',
        maxLevel: 25
    },
    antqueen: {
        name: 'èšå',
        description: 'èš‚èšæ—ç¾¤çš„é¦–é¢†ï¼Œä¼šå¬å”¤æŠ¤å«ï¼ŒBossçº§æ€ªç‰©',
        health: [600, 1800, 5400, 16200, 48600, 145800, 437400, 1312200, 3936600, 11809800, 35429400, 106288200, 318864600, 956593800, 2869781400, 8609344200, 25828032600, 77484097800, 232452293400, 697356880200, 2092070640600, 6276211921800, 18828635765400, 56485907296200, 169457721888600],
        bodyDamage: [2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 65536, 131072, 262144, 524288, 1048576, 2097152, 4194304, 8388608, 16777216, 33554432],
        weight: [900, 2700, 8100, 24300, 72900, 218700, 656100, 1968300, 5904900, 17714700, 53144100, 159432300, 478296900, 1434890700, 4304672100, 12914016300, 38742048900, 116226146700, 348678440100, 1046035320300, 3138105960900, 9414317882700, 28242953648100, 84728860944300, 254186582832900],
        drops: [15, 17], // çç å’Œèš‚èšè›‹
        rarity: 'legendary',
        behaviors: ['å¬å”¤', 'é¦–é¢†', 'Boss', 'æŠ¤å«'],
        icon: 'ğŸ‘‘',
        maxLevel: 25
    },
    bee: {
        name: 'èœœèœ‚',
        description: 'ç¾¤å±…é£è¡Œæ€ªç‰©ï¼Œä¸ç“¢è™«æœ‰ç›¸ä¼¼çš„æ‰è½',
        health: [54, 162, 486, 1458, 4374, 13122, 39366, 118098, 354294, 1062882, 3188646, 9565938, 28697814, 86093442, 258280326, 774840978, 2324522934, 6973568802, 20920706406, 62762119218, 188286357654, 564859072962, 1694577218886, 5083731656658, 15251194969974],
        bodyDamage: [20, 40, 80, 160, 320, 640, 1280, 2560, 5120, 10240, 20480, 40960, 81920, 163840, 327680, 655360, 1310720, 2621440, 5242880, 10485760, 20971520, 41943040, 83886080, 167772160, 335544320],
        weight: [36, 108, 324, 972, 2916, 8748, 26244, 78732, 236196, 708588, 2125764, 6377292, 19131876, 57395628, 172186884, 516560652, 1549681956, 4649045868, 13947137604, 41841412812, 125524238436, 376572715308, 1129718145924, 3389154437772, 10167463313316],
        drops: [4, 11], // ä¸ç“¢è™«ç›¸åŒçš„æ‰è½ç‰©
        rarity: 'common',
        behaviors: ['ç¾¤ä½“', 'é£è¡Œ', 'æ•°é‡ä¼˜åŠ¿'],
        icon: 'ğŸ',
        maxLevel: 25
    },
    healbug: {
        name: 'æ²»ç–—è™«',
        description: 'è¾…åŠ©å‹æ€ªç‰©ï¼Œä¼šæ²»ç–—å…¶ä»–æ€ªç‰©',
        health: [40, 120, 360, 1080, 3240, 9720, 29160, 87480, 262440, 787320, 2361960, 7085880, 21257640, 63772920, 191318760, 573956280, 1721868840, 5165606520, 15496819560, 46490458680, 139471376040, 418414128120, 1255242384360, 3765727153080, 11297181459240],
        bodyDamage: [5, 10, 20, 40, 80, 160, 320, 640, 1280, 2560, 5120, 10240, 20480, 40960, 81920, 163840, 327680, 655360, 1310720, 2621440, 5242880, 10485760, 20971520, 41943040, 83886080],
        weight: [32, 96, 288, 864, 2592, 7776, 23328, 69984, 209952, 629856, 1889568, 5668704, 17006112, 51018336, 153055008, 459165024, 1377495072, 4132485216, 12397455648, 37192366944, 111577100832, 334731302496, 1004193907488, 3012581722464, 9037745167392],
        drops: [4, 16, 18], // ç¿…è†€ã€ç£é“ã€ç¬¬ä¸‰çœ¼
        rarity: 'uncommon',
        behaviors: ['æ²»ç–—', 'è¾…åŠ©', 'ç¾¤ä½“å¢ç›Š'],
        icon: 'ğŸ’š',
        maxLevel: 25
    },
    sandstorm: {
        name: 'æ²™å°˜æš´',
        description: 'ä¸æ”»å‡»ç©å®¶ï¼Œåªæ˜¯å››å¤„ç§»åŠ¨çš„å’Œå¹³ç”Ÿç‰©',
        health: [30, 90, 270, 810, 2430, 7290, 21870, 65610, 196830, 590490, 1771470, 5314410, 15943230, 47829690, 143489070, 430467210, 1291401630, 3874204890, 11622614670, 34867844010, 104603532030, 313810596090, 941431788270, 2824295364810, 8472886094430],
        bodyDamage: [2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 65536, 131072, 262144, 524288, 1048576, 2097152, 4194304, 8388608, 16777216, 33554432],
        weight: [60, 180, 540, 1620, 4860, 14580, 43740, 131220, 393660, 1180980, 3542940, 10628820, 31886460, 95659380, 286978140, 860934420, 2582803260, 7748409780, 23245229340, 69735688020, 209207064060, 627621192180, 1882863576540, 5648590729620, 16945772188860], // babyantçš„é‡é‡ * 3
        drops: [19], // çˆ†ç‚¸èŠ±ç“£
        rarity: 'epic',
        behaviors: ['å’Œå¹³', 'ç¼“æ…¢', 'æ²™å°˜'],
        icon: 'ğŸŒªï¸',
        maxLevel: 25
    }
};

// ç¨€æœ‰åº¦é…ç½®
const RARITY_CONFIG = {
    common: { color: '#87ceeb', name: 'æ™®é€š' },
    uncommon: { color: '#90ee90', name: 'ç½•è§' },
    rare: { color: '#da70d6', name: 'ç¨€æœ‰' },
    epic: { color: '#ffa500', name: 'å²è¯—' },
    legendary: { color: '#ff6b6b', name: 'ä¼ è¯´' }
};

// è·å–æ€ªç‰©åœ¨æŒ‡å®šç­‰çº§çš„å±æ€§
function getMonsterStats(monsterType, level) {
    const monster = MONSTER_DATA[monsterType];
    if (!monster || level < 1 || level > monster.health.length) {
        return null;
    }

    const levelIndex = level - 1;
    return {
        name: monster.name,
        health: monster.health[levelIndex],
        bodyDamage: monster.bodyDamage[levelIndex],
        weight: monster.weight[levelIndex],
        description: monster.description,
        rarity: monster.rarity,
        behaviors: monster.behaviors,
        drops: monster.drops,
        icon: monster.icon,
        maxLevel: monster.maxLevel
    };
}

// è·å–æ‰è½ç‰©ä¿¡æ¯
function getDropInfo(dropArray) {
    if (!dropArray || dropArray.length === 0) {
        return [];
    }

    return dropArray.map(dropType => ({
        type: dropType,
        name: PETAL_NAMES[dropType] || `æœªçŸ¥${dropType}`,
        rarity: getItemRarity(dropType)
    }));
}

// æ ¹æ®æ‰è½ç‰©ç±»å‹åˆ¤æ–­ç¨€æœ‰åº¦
function getItemRarity(dropType) {
    // æ ¹æ®èŠ±ç“£ç±»å‹åˆ¤æ–­ç¨€æœ‰åº¦
    if ([0, 1, 3, 4].includes(dropType)) return 'common';      // å¯¼å¼¹ã€åŸºç¡€ã€å¶å­ã€ç¿…è†€
    if ([5, 9, 11, 16, 17].includes(dropType)) return 'uncommon'; // é›·ç”µã€ç£é“ã€é»„èœ‚å¯¼å¼¹
    if ([6, 7, 10, 18].includes(dropType)) return 'rare';         // æ¯’æ¶²ã€ç›¾ç‰Œã€ç¬¬ä¸‰çœ¼
    if ([8, 13].includes(dropType)) return 'epic';                // ç‚¸å¼¹ã€çˆ†ç‚¸
    if ([12, 15, 19].includes(dropType)) return 'legendary';      // çç ã€èš‚èšè›‹
    return 'common';
}

// è·å–ç©å®¶èƒ½æŸ¥çœ‹çš„æœ€é«˜æ€ªç‰©ç­‰çº§ï¼ˆåŸºäºç©å®¶æœ€é«˜èŠ±ç“£ç­‰çº§+3ï¼‰
function getMaxMonsterLevel() {
    // è®¡ç®—ç©å®¶çš„æœ€é«˜èŠ±ç“£ç­‰çº§
    let maxPetalLevel = 0;
    if (gameState && gameState.availablePetals) {
        gameState.availablePetals.forEach(petal => {
            if (petal.level && petal.level > maxPetalLevel) {
                maxPetalLevel = petal.level;
            }
        });
    }

    // å¦‚æœæ²¡æœ‰èŠ±ç“£æ•°æ®ï¼Œé»˜è®¤æ˜¾ç¤ºåˆ°10çº§
    if (maxPetalLevel === 0) {
        maxPetalLevel = 7; // é»˜è®¤æ˜¾ç¤ºåˆ°10çº§
    }

    return Math.min(maxPetalLevel + 3, 25); // æœ€é«˜æ˜¾ç¤ºåˆ°25çº§
}

// æ ¼å¼åŒ–æ•°å­—æ˜¾ç¤º
function formatNumber(num) {
    if (num === undefined || num === null) {
        return '0';
    }
    if (num >= 1000000000) {
        return (num / 1000000000).toFixed(1) + 'B';
    } else if (num >= 1000000) {
        return (num / 1000000).toFixed(1) + 'M';
    } else if (num >= 1000) {
        return (num / 1000).toFixed(1) + 'K';
    }
    return num.toString();
}

// å¯¼å‡ºæ•°æ®ä¾›å…¶ä»–æ¨¡å—ä½¿ç”¨
if (typeof module !== 'undefined' && module.exports) {
    module.exports = {
        MONSTER_DATA,
        PETAL_NAMES,
        RARITY_CONFIG,
        getMonsterStats,
        getDropInfo,
        getItemRarity,
        getMaxMonsterLevel,
        formatNumber
    };
}